@model MVC_with_EF__CRUD_.Models.tblStudent
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>
@using (Html.BeginForm("insertupdate", "Default", FormMethod.Post))
{
    <table>
        @Html.HiddenFor(i => i.id)
        <tr>
            <td>Name:</td>
            <td>@Html.TextBoxFor(n => n.name)</td>
        </tr>

        <tr>
            <td>Age:</td>
            <td>@Html.TextBoxFor(a => a.age)</td>
        </tr>

        <tr>
            <td>State:</td>
            <td>@Html.DropDownListFor(s => s.state, new SelectList(ViewBag.st, "sid", "sname"), "--select--", new {onchange="bindcity()"})</td>
        </tr>

        <tr>
            <td>City:</td>
            <td>@Html.DropDownListFor(c => c.city, new SelectList(ViewBag.ct, "cid", "cname"), "--select--")</td>
        </tr>

        <tr>
            <td>Gender:</td>
            <td>@Html.DropDownListFor(g => g.gender, new SelectList(ViewBag.ge, "gid", "gname"), "--select--")</td>
        </tr>

        <tr>
            <td></td>
            <td><input type="submit" value="@ViewBag.btn" /></td>
        </tr>
    </table>
}
<script src="~/Scripts/jquery-3.7.0.min.js"></script>
<script type="text/javascript">
    function bindcity() {
        var stateid = $("#state").val();
        $.ajax({
            url: '../Default/getcity',
            type: 'post',
            data: { sid: stateid },
            success: function (data) {
                $("#city").empty();
                $("#city").append($('<option></option').html("--select--").val(0));
                for (var i = 0; i < data.length; i++) {
                    $("#city").append($('<option></option').html(data[i].cname).val(data[i].cid));
                }
            },
            Error: function () {
                alert("Error in city binding");
            }
        });
    }
</script>
